From 80b111b7e047118722e4659d65b14104c65b9817 Mon Sep 17 00:00:00 2001
From: charwliu <charwliu@ngboss.com>
Date: Mon, 17 May 2021 17:05:21 +0800
Subject: [PATCH 1/2] Revert "r8169: don't advertise pause in jumbo mode"

This reverts commit b2df20c0f19f9f4f82fa1b1fdd0c8b22c6fc76b5.
---
 drivers/net/ethernet/realtek/r8169_main.c | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

diff --git a/drivers/net/ethernet/realtek/r8169_main.c b/drivers/net/ethernet/realtek/r8169_main.c
index 3bb36f4a984e..f981aa899c82 100644
--- a/drivers/net/ethernet/realtek/r8169_main.c
+++ b/drivers/net/ethernet/realtek/r8169_main.c
@@ -2420,13 +2420,6 @@ static void rtl_jumbo_config(struct rtl8169_private *tp)
 
 	if (pci_is_pcie(tp->pci_dev) && tp->supports_gmii)
 		pcie_set_readrq(tp->pci_dev, readrq);
-
-	/* Chip doesn't support pause in jumbo mode */
-	linkmode_mod_bit(ETHTOOL_LINK_MODE_Pause_BIT,
-			 tp->phydev->advertising, !jumbo);
-	linkmode_mod_bit(ETHTOOL_LINK_MODE_Asym_Pause_BIT,
-			 tp->phydev->advertising, !jumbo);
-	phy_start_aneg(tp->phydev);
 }
 
 DECLARE_RTL_COND(rtl_chipcmd_cond)
@@ -4718,6 +4711,8 @@ static int r8169_phy_connect(struct rtl8169_private *tp)
 	if (!tp->supports_gmii)
 		phy_set_max_speed(phydev, SPEED_100);
 
+	phy_support_asym_pause(phydev);
+
 	phy_attached_info(phydev);
 
 	return 0;
-- 
2.31.1

